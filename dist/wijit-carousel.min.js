/**
 * @author Holmes Bryant <https://github.com/HolmesBryant>
 * @license GPL-3.0
 */
export class WijitCarousel extends HTMLElement{#t=new AbortController;activeindicator="active";#e=!0;#n=!1;#i=!1;#a=["fade","flip","slide","slip"];#s="slide";#r=3;#o=0;#l=1;#c="carda";#d=1;#p=[];static observedAttributes=["autoplay","clickauto","controls","effect","pause","repeat","speed"];constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML=`\n\t\t\t<style>\n\t\t\t\t:host {\n\t\t\t\t\t--overflow: hidden;\n\t\t\t\t\t--panel-height: 300px;\n\t\t\t\t\t--perspective: 1800px;\n\t\t\t\t\t--perspective-origin: center;\n\t\t\t\t\t--speed: ${this.speed}s;\n\t\t\t\t\t--transition-timing: ease-out;\n\t\t\t\t\tdisplay: block;\n\t\t\t\t}\n\n\t\t\t\t.hidden {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\n\t\t\t\t#panel {\n\t\t\t\t\theight: var(--panel-height);\n\t\t\t\t\topacity: 1;\n\t\t\t\t\toverflow: hidden;\n\t\t\t\t\tposition: relative;\n          transform-style: preserve-3d;\n\t\t\t\t\ttransition: all var(--speed);\n\t\t\t\t\ttransition-timing-function: var(--transition-timing);\n\t\t\t\t\twhite-space: nowrap;\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\tperspective: var(--perspective);\n\t\t\t\t\tperspective-origin: var(--perspective-origin);\n\t\t\t\t}\n\n\t\t\t\t#panel.fade-out {\n\t\t\t\t\topacity: 0;\n\t\t\t\t}\n\n\t\t\t\t#panel.flipped {\n\t\t\t\t\toverflow: visible;\n\t\t\t\t\tz-index: 1000;\n\t\t\t\t}\n\n\t\t\t\t#panel.flipped #carda,\n\t\t\t\t#panel.flipped #cardb {\n          backface-visibility: hidden;\n\t\t\t\t\theight: 100%;\n          position: absolute;\n          width: 100%;\n\t\t\t\t}\n\n\t\t\t\t#panel.a.flipped #cardb {\n\t\t\t\t\ttransform: rotateY(-180deg);\n\t\t\t\t}\n\n\t\t\t\t#panel.b.flipped #carda {\n\t\t\t\t\ttransform: rotateY(-180deg);\n\t\t\t\t}\n\n\t\t\t\t#panel.a.flip #carda {\n\t\t\t\t\ttransform: rotateY(180deg);\n\t\t\t\t\ttransition: all var(--speed);\n\t\t\t\t\ttransition-timing-function: var(--transition-timing);\n\t\t\t\t}\n\n\t\t\t\t#panel.a.flip #cardb {\n\t\t\t\t\ttransform: rotateY(0deg);\n\t\t\t\t\ttransition: all var(--speed);\n\t\t\t\t\ttransition-timing-function: var(--transition-timing);\n\t\t\t\t}\n\n\t\t\t\t#panel.b.flip #carda {\n\t\t\t\t\ttransform: rotateY(0deg);\n\t\t\t\t\ttransition: all var(--speed);\n\t\t\t\t\ttransition-timing-function: var(--transition-timing);\n\t\t\t\t}\n\n\t\t\t\t#panel.b.flip #cardb {\n\t\t\t\t\ttransform: rotateY(180deg);\n\t\t\t\t\ttransition: all var(--speed);\n\t\t\t\t\ttransition-timing-function: var(--transition-timing);\n\t\t\t\t}\n\n\t\t\t\t#panel.slide-left #carda,\n\t\t\t\t#panel.slide-left #cardb {\n\t\t\t\t\tleft: -100%;\n\t\t\t\t\ttransition: all var(--speed);\n\t\t\t\t\ttransition-timing-function: var(--transition-timing);\n\t\t\t\t}\n\n\t\t\t\t#panel.b.slip-left #carda {\n\t\t\t\t\ttransition: all var(--speed);\n\t\t\t\t\ttransition-timing-function: var(--transition-timing);\n\t\t\t\t\twidth: 0%;\n\t\t\t\t}\n\n\t\t\t\t#panel.a.slip-left #cardb {\n\t\t\t\t\ttransition: all var(--speed);\n\t\t\t\t\ttransition-timing-function: var(--transition-timing);\n\t\t\t\t\twidth: 0%;\n\t\t\t\t}\n\n\t\t\t\t#carda,\n\t\t\t\t#cardb {\n\t\t\t\t\tdisplay: inline-block;\n\t\t\t\t\theight: 100%;\n\t\t\t\t\tleft: 0;\n\t\t\t\t\toverflow: var(--overflow);\n\t\t\t\t\tposition: relative;\n\t\t\t\t\ttext-align: center;\n\t\t\t\t\tvertical-align: top;\n\t\t\t\t\twhite-space: wrap;\n\t\t\t\t\twidth: 100%;\n\t\t\t\t}\n\n\t\t\t\t#controls {\n\t\t\t\t\ttext-align: center;\n\t\t\t\t}\n\n\t\t\t\t/* Touch devices */\n\t\t\t\t/*@media (hover: none) {\n\t\t\t\t\t.scroller { overflow-x: auto; }\n\t\t\t\t}*/\n\t\t\t</style>\n\n\t\t\t<div id="container" part="container">\n\t\t\t\t<div id="panel" part="panel">\n\t\t\t\t\t<div id="carda" part="card"><slot name="carda"></slot></div>\n\t\t\t\t\t<div id="cardb" part="card"><slot name="cardb"></slot></div>\n\t\t\t\t</div>\n\t\t\t\t<div id="controls" part="controls">\n\t\t\t\t\t<slot name="controls"></slot>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div hidden id="slides" class="hidden"><slot></slot></div>\n\t\t\t`}attributeChangedCallback(t,e,n){this[t]=n}connectedCallback(){this.slides=Array.from(this.children).filter((t=>!t.hasAttribute("slot")));let t=this.querySelectorAll("*[slot=controls]");this.slides&&this.initSlides(this.slides),0===t.length&&(t=this.createControls()),this.#p=this.initControls(t)}disconnectedCallback(){this.#t.abort()}initSlides(t){let e=0;for(t[0].setAttribute("slot","carda");e<t.length;e++)t[e].setAttribute("data-slide",e),this.clickauto&&t[e].addEventListener("click",(t=>{"input"==t.target.localName||"select"==t.target.localName||"textarea"==t.target.localName?this.autoplay=!1:(this.autoplay=!this.autoplay,this.autoplay&&this.play(this.#d++))}),{signal:this.#t.signal});return t}createControls(){const t=new DocumentFragment,e=document.createElement("input");e.type="radio",e.name="c"+Math.random(),e.setAttribute("slot","controls"),this.slides.forEach(((n,i)=>{const a=e.cloneNode(!0);0===i&&(a.checked=!0),this.controls||a.setAttribute("hidden","true"),t.append(a)}));const n=t.querySelectorAll("input");return n[0].checked=!0,this.append(t),n}initControls(t){let e=0;for(t[0].setAttribute(this.activeindicator,"true");e<t.length;e++)t[e].setAttribute("data-target",e),t[e].addEventListener("click",(e=>{this.transition(e);for(const n of t)n.removeAttribute(this.activeindicator),e.target.setAttribute(this.activeindicator,"true")}),{signal:this.#t.signal});return t}transition(t){const e=this.shadowRoot.querySelector("#panel"),n=t.target.getAttribute("data-target"),i=this.querySelector(`[slot='${this.#c}']`),a=this.querySelector(`[data-slide='${n}']`),s="carda"===this.#c?"cardb":"carda";if(i!==a)switch(a.setAttribute("slot",s),this.#c=s,this.effect){case"slip":const t="carda"===this.#c?"a":"b";e.classList.add(t),e.classList.add("slip-left"),this.endEffect(a,["slip-left",t]);break;case"fade":e.classList.add("fade-out"),this.endEffect(a,["fade-out"]);break;case"flip":const n="carda"===this.#c?"b":"a";e.classList.add("flipped"),e.classList.add(n),setTimeout((()=>{e.classList.add("flip")}),5),this.endEffect(a,["flipped",n,"flip"]);break;default:e.classList.add("slide-left"),this.endEffect(a,["slide-left"])}}endEffect(t,e=[]){const n=this.shadowRoot.querySelector("#panel");let i=new AbortController;n.addEventListener("transitionend",(t=>{i.abort(),i=null;const a="carda"===this.#c?"cardb":"carda",s=this.querySelector(`[slot=${a}]`),r=n.querySelector(`#${a}`);s.removeAttribute("slot");for(const t of e)n.classList.remove(t);if(n.append(r),this.enableControls(),this.autoplay){const t=1e3*this.pause;setTimeout((()=>{this.play(this.#d++)}),t)}}),{signal:i.signal}),this.disableControls()}disableControls(t=this.#p){for(const e of t)e.disabled=!0}enableControls(t=this.#p){for(const e of t)e.disabled=!1}play(t=this.#d){if(!this.autoplay)return;const e=this.slides.length*this.repeat,n=t%this.#p.length;this.#p[n].click(),0!==e&&t>=e&&(this.autoplay=!1,this.#d=1)}get autoplay(){return this.#i}set autoplay(t){switch(t){case"false":case!1:t=!1,this.#d=1;break;default:t=!0,this.play(this.#d++)}this.#i=t}get clickauto(){return this.#e}set clickauto(t){switch(t){case"false":case!1:t=!1;break;default:t=!0}this.#e=t}get controls(){return this.#n}set controls(t){switch(t){case"false":case!1:t=!1;break;default:t=!0}this.#n=t}get effect(){return this.#s}set effect(t){this.#s=t}get pause(){return this.#r}set pause(t){t=parseFloat(t),isNaN(t)&&(t=0),t<0&&(t=0),0===t&&this.style.setProperty("--transition-timing","linear"),this.#r=t}get repeat(){return this.#o}set repeat(t){this.#o=t}get speed(){return this.#l}set speed(t){t=parseFloat(t),this.#l=t,this.style.setProperty("--speed",`${t}s`)}}document.addEventListener("DOMContentLoaded",customElements.define("wijit-carousel",WijitCarousel));
